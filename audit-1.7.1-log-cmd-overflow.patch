diff -urp audit-1.6.5.orig/lib/audit_logging.c audit-1.6.5/lib/audit_logging.c
--- audit-1.6.5.orig/lib/audit_logging.c	2008-04-01 16:33:34.000000000 -0400
+++ audit-1.6.5/lib/audit_logging.c	2008-04-01 16:34:12.000000000 -0400
@@ -652,7 +652,10 @@ int audit_log_user_command(int audit_fd,
 	}
 
 	p = cmd;
-	strcpy(commname, cmd);
+	if (len >= PATH_MAX) {
+		cmd[PATH_MAX] = 0;
+		len = PATH_MAX-1;
+	}
 	while (*p) {
 		if (*p == '"' || *p < 0x21 || (unsigned)*p > 0x7f) {
 			_audit_c2x(commname, cmd, len);
